<!doctype html>
<html lang="he" dir="rtl">
<head>
  <meta charset="utf-8" />
  <title>השוואת סל קניות — גרסה משודרגת</title>
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <style>
    body { font-family: Arial, sans-serif; margin: 18px; direction: rtl; }
    textarea { width:100%; height:120px; }
    input, button { padding:8px; margin:6px 0; }
    pre { background:#f4f4f4; padding:12px; white-space:pre-wrap; }
  </style>
</head>
<body>
  <h1>השוואת סל קניות</h1>

  <label>שפה:
    <select id="lang">
      <option value="he">עברית</option>
      <option value="en">English</option>
    </select>
  </label><br/>

  <label>כתובת: <input id="address" value="רחוב אילת 12, חולון" style="width:60%"/></label><br/>
  <label>רדיוס (ק״מ): <input id="radius" value="2" style="width:60px"/></label><br/>
  <label>רשימת קניות (שורה לכל פריט):</label><br/>
  <textarea id="items">קוקה קולה 1.5 ליטר
מים מינרליים 1.5 ליטר
פסטה</textarea><br/>
  <button id="search">חפש</button>

  <h2>תוצאות (JSON):</h2>
  <pre id="out">לחץ חפש כדי להתחיל…</pre>

<script>
document.getElementById("search").onclick = async () => {
  const address = document.getElementById("address").value;
  const radius_km = Number(document.getElementById("radius").value);
  const items = document.getElementById("items").value.split("\\n").map(s=>s.trim()).filter(Boolean);
  const language = document.getElementById("lang").value;
  document.getElementById("out").textContent = "מבצע חיפוש…";

  try {
    const res = await fetch("/api/search", {
      method: "POST",
      headers: {"Content-Type":"application/json"},
      body: JSON.stringify({ address, radius_km, items, language })
    });
    const data = await res.json();
    document.getElementById("out").textContent = JSON.stringify(data, null, 2);
  } catch (e) {
    document.getElementById("out").textContent = "שגיאה: " + e.message;
  }
};
</script>
</body>
</html>
